{
  "id": "cluster-004",
  "name": "Create cluster without automatic admin permissions",
  "description": "Policy that grants the ability to create clusters with bootstrapClusterCreatorAdminPermissions set to false, removing automatic admin access for the creator.",
  "policyFile": "create-cluster-without-admin.cedar",
  "testCases": [
    {
      "description": "User can create cluster when bootstrapClusterCreatorAdminPermissions is false",
      "request": {
        "action": "CreateCluster",
        "resource": "arn:aws:rosa:us-west-2:111122223333:cluster/new-cluster",
        "context": {
          "bootstrapClusterCreatorAdminPermissions": "false"
        }
      },
      "expectedResult": "ALLOW"
    },
    {
      "description": "User cannot create cluster when bootstrapClusterCreatorAdminPermissions is true",
      "request": {
        "action": "CreateCluster",
        "resource": "arn:aws:rosa:us-west-2:111122223333:cluster/new-cluster",
        "context": {
          "bootstrapClusterCreatorAdminPermissions": "true"
        }
      },
      "expectedResult": "DENY"
    },
    {
      "description": "User cannot create cluster when bootstrapClusterCreatorAdminPermissions is not specified",
      "request": {
        "action": "CreateCluster",
        "resource": "arn:aws:rosa:us-west-2:111122223333:cluster/new-cluster",
        "context": {}
      },
      "expectedResult": "DENY"
    }
  ],
  "notes": "This is a security best practice to prevent automatic admin access. The cluster access should be managed explicitly through access entries."
}
