{
  "id": "nodepool-001",
  "name": "Manage node pools for a specific cluster",
  "description": "Policy that grants the ability to create, update, delete, and describe node pools for a specific ROSA cluster only.",
  "policyFile": "manage-nodepools-for-cluster.cedar",
  "testCases": [
    {
      "description": "User can create node pool for prod-cluster",
      "request": {
        "action": "CreateNodePool",
        "resource": "arn:aws:rosa:us-west-2:111122223333:cluster/prod-cluster"
      },
      "expectedResult": "ALLOW"
    },
    {
      "description": "User can update node pool config",
      "request": {
        "action": "UpdateNodePool",
        "resource": "arn:aws:rosa:us-west-2:111122223333:nodepool/prod-cluster/workers/abc123"
      },
      "expectedResult": "ALLOW"
    },
    {
      "description": "User cannot create node pool for different cluster",
      "request": {
        "action": "CreateNodePool",
        "resource": "arn:aws:rosa:us-west-2:111122223333:cluster/dev-cluster"
      },
      "expectedResult": "DENY"
    },
    {
      "description": "User cannot delete the cluster itself",
      "request": {
        "action": "DeleteCluster",
        "resource": "arn:aws:rosa:us-west-2:111122223333:cluster/prod-cluster"
      },
      "expectedResult": "DENY"
    }
  ],
  "notes": "NodePool ARN format is arn:aws:rosa:region:account:nodepool/cluster-name/nodepool-name/uuid. The second permit block uses a Cedar 'like' operator with wildcard to match all node pools in the cluster, since Cedar does not support ARN wildcards within resource references."
}
