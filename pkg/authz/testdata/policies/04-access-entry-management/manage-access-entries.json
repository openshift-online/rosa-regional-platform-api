{
  "id": "access-entry-001",
  "name": "Manage access entries for a cluster",
  "description": "Policy that grants the ability to create, delete, and manage ROSA access entries which control who can access the Kubernetes API.",
  "policyFile": "manage-access-entries.cedar",
  "testCases": [
    {
      "description": "User can create access entry",
      "request": {
        "action": "CreateAccessEntry",
        "resource": "arn:aws:rosa:us-west-2:111122223333:cluster/my-cluster"
      },
      "expectedResult": "ALLOW"
    },
    {
      "description": "User can update access entry",
      "request": {
        "action": "UpdateAccessEntry",
        "resource": "arn:aws:rosa:us-west-2:111122223333:access-entry/my-cluster/role/admin-entry"
      },
      "expectedResult": "ALLOW"
    },
    {
      "description": "User can list access policies (global)",
      "request": {
        "action": "ListAccessPolicies",
        "resource": "*"
      },
      "expectedResult": "ALLOW"
    },
    {
      "description": "User cannot manage access entries for different cluster",
      "request": {
        "action": "CreateAccessEntry",
        "resource": "arn:aws:rosa:us-west-2:111122223333:cluster/other-cluster"
      },
      "expectedResult": "DENY"
    }
  ],
  "notes": "Access entries control who can access the Kubernetes API. ListAccessPolicies requires wildcard resource. AssociateAccessPolicy and DisassociateAccessPolicy from V0 are mapped to UpdateAccessEntry in Cedar."
}
