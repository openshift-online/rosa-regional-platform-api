{
  "id": "access-entry-002",
  "name": "Restrict access entry scope to namespaces",
  "description": "Policy that allows creating access entries but only with namespace-scoped access, not cluster-wide admin access.",
  "policyFile": "restrict-access-entry-scope.cedar",
  "testCases": [
    {
      "description": "User can create namespace-scoped access entry",
      "request": {
        "action": "CreateAccessEntry",
        "resource": "arn:aws:rosa:us-west-2:111122223333:cluster/my-cluster",
        "context": {
          "accessScope": "namespace"
        }
      },
      "expectedResult": "ALLOW"
    },
    {
      "description": "User cannot create cluster-scoped access entry",
      "request": {
        "action": "CreateAccessEntry",
        "resource": "arn:aws:rosa:us-west-2:111122223333:cluster/my-cluster",
        "context": {
          "accessScope": "cluster"
        }
      },
      "expectedResult": "DENY"
    },
    {
      "description": "User can update namespace-scoped access entry",
      "request": {
        "action": "UpdateAccessEntry",
        "resource": "arn:aws:rosa:us-west-2:111122223333:access-entry/my-cluster/role/dev-entry",
        "context": {
          "accessScope": "namespace"
        }
      },
      "expectedResult": "ALLOW"
    }
  ],
  "notes": "This prevents granting cluster-admin level access while allowing namespace-level access delegation. Useful for team leads who can grant access within their namespace. AssociateAccessPolicy from V0 is mapped to UpdateAccessEntry in Cedar."
}
