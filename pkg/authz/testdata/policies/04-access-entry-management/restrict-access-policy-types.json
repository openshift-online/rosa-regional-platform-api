{
  "id": "access-entry-003",
  "name": "Restrict which access policies can be associated",
  "description": "Policy that restricts which ROSA access policies can be associated with access entries, preventing admin-level grants.",
  "policyFile": "restrict-access-policy-types.cedar",
  "testCases": [
    {
      "description": "User can associate view policy",
      "request": {
        "action": "UpdateAccessEntry",
        "resource": "arn:aws:rosa:us-west-2:111122223333:access-entry/my-cluster/role/dev",
        "context": {
          "policyArn": "arn:aws:rosa::aws:cluster-access-policy/ROSAViewPolicy"
        }
      },
      "expectedResult": "ALLOW"
    },
    {
      "description": "User can associate edit policy",
      "request": {
        "action": "UpdateAccessEntry",
        "resource": "arn:aws:rosa:us-west-2:111122223333:access-entry/my-cluster/role/dev",
        "context": {
          "policyArn": "arn:aws:rosa::aws:cluster-access-policy/ROSAEditPolicy"
        }
      },
      "expectedResult": "ALLOW"
    },
    {
      "description": "User cannot associate cluster admin policy",
      "request": {
        "action": "UpdateAccessEntry",
        "resource": "arn:aws:rosa:us-west-2:111122223333:access-entry/my-cluster/role/dev",
        "context": {
          "policyArn": "arn:aws:rosa::aws:cluster-access-policy/ROSAClusterAdminPolicy"
        }
      },
      "expectedResult": "DENY"
    },
    {
      "description": "User cannot associate admin policy",
      "request": {
        "action": "UpdateAccessEntry",
        "resource": "arn:aws:rosa:us-west-2:111122223333:access-entry/my-cluster/role/dev",
        "context": {
          "policyArn": "arn:aws:rosa::aws:cluster-access-policy/ROSAAdminPolicy"
        }
      },
      "expectedResult": "DENY"
    }
  ],
  "notes": "This is a key security control to prevent privilege escalation through access entries. Team leads can grant view/edit access but not admin access. AssociateAccessPolicy from V0 is mapped to UpdateAccessEntry in Cedar."
}
