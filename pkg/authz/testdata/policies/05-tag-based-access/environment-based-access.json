{
  "id": "abac-002",
  "name": "Access based on environment tag",
  "description": "Policy that allows full access to development clusters but only read access to production clusters, based on Environment tag.",
  "policyFile": "environment-based-access.cedar",
  "testCases": [
    {
      "description": "User can create nodepool for dev cluster",
      "request": {
        "action": "CreateNodePool",
        "resource": "arn:aws:rosa:us-west-2:111122223333:cluster/dev-cluster",
        "resourceTags": {
          "Environment": "development"
        }
      },
      "expectedResult": "ALLOW"
    },
    {
      "description": "User can delete dev cluster",
      "request": {
        "action": "DeleteCluster",
        "resource": "arn:aws:rosa:us-west-2:111122223333:cluster/dev-cluster",
        "resourceTags": {
          "Environment": "development"
        }
      },
      "expectedResult": "ALLOW"
    },
    {
      "description": "User can describe prod cluster",
      "request": {
        "action": "DescribeCluster",
        "resource": "arn:aws:rosa:us-west-2:111122223333:cluster/prod-cluster",
        "resourceTags": {
          "Environment": "production"
        }
      },
      "expectedResult": "ALLOW"
    },
    {
      "description": "User cannot delete prod cluster",
      "request": {
        "action": "DeleteCluster",
        "resource": "arn:aws:rosa:us-west-2:111122223333:cluster/prod-cluster",
        "resourceTags": {
          "Environment": "production"
        }
      },
      "expectedResult": "DENY"
    },
    {
      "description": "User cannot update prod cluster config",
      "request": {
        "action": "UpdateClusterConfig",
        "resource": "arn:aws:rosa:us-west-2:111122223333:cluster/prod-cluster",
        "resourceTags": {
          "Environment": "production"
        }
      },
      "expectedResult": "DENY"
    },
    {
      "description": "User can tag dev cluster resources",
      "request": {
        "action": "TagResource",
        "resource": "arn:aws:rosa:us-west-2:111122223333:cluster/dev-cluster",
        "resourceTags": {
          "Environment": "development"
        },
        "context": {
          "tagKeys": ["CostCenter"]
        }
      },
      "expectedResult": "ALLOW"
    },
    {
      "description": "User cannot tag prod cluster resources",
      "request": {
        "action": "TagResource",
        "resource": "arn:aws:rosa:us-west-2:111122223333:cluster/prod-cluster",
        "resourceTags": {
          "Environment": "production"
        },
        "context": {
          "tagKeys": ["CostCenter"]
        }
      },
      "expectedResult": "DENY"
    }
  ],
  "notes": "Common pattern for giving developers full access to dev environments while protecting production. Works with tag-based resource organization."
}
