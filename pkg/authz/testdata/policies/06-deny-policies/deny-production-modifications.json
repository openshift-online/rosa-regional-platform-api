{
  "id": "deny-002",
  "name": "Deny modifications to production clusters",
  "description": "Policy that denies any write operations on clusters tagged as production environment. Protects production from accidental changes.",
  "policyFile": "deny-production-modifications.cedar",
  "testCases": [
    {
      "description": "Cannot delete production cluster",
      "request": {
        "action": "DeleteCluster",
        "resource": "arn:aws:rosa:us-west-2:111122223333:cluster/prod-cluster",
        "resourceTags": {
          "Environment": "production"
        }
      },
      "expectedResult": "DENY"
    },
    {
      "description": "Cannot update production nodepool",
      "request": {
        "action": "UpdateNodePool",
        "resource": "arn:aws:rosa:us-west-2:111122223333:nodepool/prod-cluster/workers/abc123",
        "resourceTags": {
          "Environment": "production"
        }
      },
      "expectedResult": "DENY"
    },
    {
      "description": "Can delete development cluster",
      "additionalPolicies": [
        "permit(\n  ?principal,\n  action,\n  resource\n);"
      ],
      "request": {
        "action": "DeleteCluster",
        "resource": "arn:aws:rosa:us-west-2:111122223333:cluster/dev-cluster",
        "resourceTags": {
          "Environment": "development"
        }
      },
      "expectedResult": "ALLOW"
    },
    {
      "description": "Can describe production cluster (read operations allowed)",
      "additionalPolicies": [
        "permit(\n  ?principal,\n  action,\n  resource\n);"
      ],
      "request": {
        "action": "DescribeCluster",
        "resource": "arn:aws:rosa:us-west-2:111122223333:cluster/prod-cluster",
        "resourceTags": {
          "Environment": "production"
        }
      },
      "expectedResult": "ALLOW"
    }
  ],
  "notes": "This deny policy should be applied broadly (to all users/groups) to protect production. It only denies write operations, not reads."
}
