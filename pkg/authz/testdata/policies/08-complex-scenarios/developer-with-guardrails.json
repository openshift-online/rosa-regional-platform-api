{
  "id": "complex-001",
  "name": "Developer role with production guardrails",
  "description": "Complex policy combining allow and deny statements to give developers broad access while protecting production resources.",
  "policyFile": "developer-with-guardrails.cedar",
  "testCases": [
    {
      "description": "Developer can describe any cluster including production",
      "request": {
        "action": "DescribeCluster",
        "resource": "arn:aws:rosa:us-west-2:111122223333:cluster/prod-cluster",
        "resourceTags": {
          "Environment": "production"
        }
      },
      "expectedResult": "ALLOW"
    },
    {
      "description": "Developer can delete dev cluster",
      "request": {
        "action": "DeleteCluster",
        "resource": "arn:aws:rosa:us-west-2:111122223333:cluster/dev-cluster",
        "resourceTags": {
          "Environment": "development"
        }
      },
      "expectedResult": "ALLOW"
    },
    {
      "description": "Developer cannot delete production cluster",
      "request": {
        "action": "DeleteCluster",
        "resource": "arn:aws:rosa:us-west-2:111122223333:cluster/prod-cluster",
        "resourceTags": {
          "Environment": "production"
        }
      },
      "expectedResult": "DENY"
    },
    {
      "description": "Developer can create cluster tagged as development",
      "principal": {
        "username": "alice"
      },
      "request": {
        "action": "CreateCluster",
        "resource": "*",
        "context": {
          "requestTags": {
            "Environment": "development",
            "Owner": "alice"
          },
          "username": "alice"
        }
      },
      "expectedResult": "ALLOW"
    },
    {
      "description": "Developer cannot create cluster tagged as production",
      "principal": {
        "username": "alice"
      },
      "request": {
        "action": "CreateCluster",
        "resource": "*",
        "context": {
          "requestTags": {
            "Environment": "production",
            "Owner": "alice"
          },
          "username": "alice"
        }
      },
      "expectedResult": "DENY"
    },
    {
      "description": "Developer cannot change Environment tag",
      "request": {
        "action": "TagResource",
        "resource": "arn:aws:rosa:us-west-2:111122223333:cluster/dev-cluster",
        "context": {
          "tagKeys": [
            "Environment"
          ]
        }
      },
      "expectedResult": "DENY"
    },
    {
      "description": "Developer cannot grant cluster admin access",
      "request": {
        "action": "UpdateAccessEntry",
        "resource": "arn:aws:rosa:us-west-2:111122223333:access-entry/dev-cluster/role/dev",
        "context": {
          "policyArn": "arn:aws:rosa::aws:cluster-access-policy/ROSAClusterAdminPolicy"
        }
      },
      "expectedResult": "DENY"
    }
  ],
  "notes": "This demonstrates combining allow and deny statements. Explicit denies always win. The policy provides broad dev access while protecting production and preventing privilege escalation."
}
